import { NextResponse } from 'next/server'; import Stripe from 'stripe'; export async function GET(){ const key=process.env.STRIPE_SECRET_KEY; const price=process.env.STRIPE_PRICE_ID; const site=process.env.NEXT_PUBLIC_SITE_URL||'http://localhost:3000'; if(!key||!price) return NextResponse.json({error:'Missing Stripe env'},{status:500}); const stripe=new Stripe(key,{apiVersion:'2024-06-20' as any}); const session=await stripe.checkout.sessions.create({ mode:'subscription', line_items:[{price,quantity:1}], success_url:`${site}/portal`, cancel_url:`${site}/portal/billing` }); return NextResponse.redirect(session.url!,303);}